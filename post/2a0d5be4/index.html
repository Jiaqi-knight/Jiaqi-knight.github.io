<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>machine learning for chaos system | DEAL-II-Fluid</title><meta name="description" content="前言：前几天，我的导师发给我一个机器学习的案例，说很感兴趣，可不可能应用在我们的实验台上。我当时的回答是我不敢轻易尝试。从做科研的角度，一直觉得这门学科是非线性动力学和统计学的高深理论，十分敬畏。简简单单地拿tensorflow建个模型，算一下，说自己结果可行，那到底思考在哪里呢？对此，我十分怀疑。 但当我开始学习chaos的一些理论，我又不得不开始思考，中间的一些联系。在此，有必要开辟一个章节，"><meta name="keywords" content="chaos"><meta name="author" content="Jiaqi"><meta name="copyright" content="Jiaqi"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://deal-ii.com/post/2a0d5be4/"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="preconnect" href="//zz.bdstatic.com"/><meta property="og:type" content="article"><meta property="og:title" content="machine learning for chaos system"><meta property="og:url" content="http://deal-ii.com/post/2a0d5be4/"><meta property="og:site_name" content="DEAL-II-Fluid"><meta property="og:description" content="前言：前几天，我的导师发给我一个机器学习的案例，说很感兴趣，可不可能应用在我们的实验台上。我当时的回答是我不敢轻易尝试。从做科研的角度，一直觉得这门学科是非线性动力学和统计学的高深理论，十分敬畏。简简单单地拿tensorflow建个模型，算一下，说自己结果可行，那到底思考在哪里呢？对此，我十分怀疑。 但当我开始学习chaos的一些理论，我又不得不开始思考，中间的一些联系。在此，有必要开辟一个章节，"><meta property="og:image" content="https://npg.copernicus.org/articles/27/373/2020/npg-27-373-2020-avatar-web.png"><meta property="article:published_time" content="2020-12-11T04:58:34.000Z"><meta property="article:modified_time" content="2020-12-11T15:41:47.439Z"><meta name="twitter:card" content="summary"><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#000')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fff')
  }
}

var getCookies = function (name) {
  const value = `; ${document.cookie}`
  const parts = value.split(`; ${name}=`)
  if (parts.length === 2) return parts.pop().split(';').shift()
}

var autoChangeMode = 'false'
var t = getCookies('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (Cookies.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><link rel="next" title="unix" href="http://deal-ii.com/post/6f1f143a/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: {"limitDay":500,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: false,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: true,
  fancybox: true,
  Snackbar: {"bookmark":{"message_prev":"按","message_next":"键将本页加入书签"},"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: true,
  highlightCopy: true,
  highlightLang: true,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false    
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isSidebar: true,
  postUpdate: '2020-12-11 23:41:47'
}</script><noscript><style>
#nav {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@master/Hexo/css/flink.min.css"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/me.webp" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">17</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">26</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">14</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fas fa-list"></i><span> 索引</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></li><li><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page"><i class="fa-fw fas fa-list"></i><span> 工具</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/x-codepen/"><i class="fa-fw fa fa-magic"></i><span> codepen</span></a></li><li><a class="site-page" href="/x-gallery/"><i class="fa-fw fa fa-beer"></i><span> gallery</span></a></li><li><a class="site-page" href="/x-shadertoy/"><i class="fa-fw fa fa-star"></i><span> shadertoy</span></a></li><li><a class="site-page" href="/x-webgl1/"><i class="fa-fw fa fa-camera-retro"></i><span> webgl1</span></a></li><li><a class="site-page" href="/x-webgl2/"><i class="fa-fw fa fa-camera-retro"></i><span> webgl2</span></a></li><li><a class="site-page" href="/x-markdown/"><i class="fa-fw fa fa-tree"></i><span> Vditor</span></a></li><li><a class="site-page" href="/plan/"><i class="fa-fw fa fa-heartbeat"></i><span> Paln</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div></div></div><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#前言："><span class="toc-number">1.</span> <span class="toc-text">前言：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#学习目标："><span class="toc-number">2.</span> <span class="toc-text">学习目标：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#基本知识："><span class="toc-number">3.</span> <span class="toc-text">基本知识：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Reasons-for-the-disappearance-of-the-gradient"><span class="toc-number">3.0.1.</span> <span class="toc-text">Reasons for the disappearance of the gradient:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Reasons-for-gradient-explosion"><span class="toc-number">3.0.2.</span> <span class="toc-text">Reasons for gradient explosion:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#How-to-solve-it"><span class="toc-number">3.0.3.</span> <span class="toc-text">How to solve it?</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Challenges-and-Opportunities-for-Machine-Learning-in-Fluid-Dynamics5"><span class="toc-number">3.0.4.</span> <span class="toc-text">Challenges and Opportunities for Machine Learning in Fluid Dynamics5</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FLOW-MODELING-WITH-MACHINE-LEARNING"><span class="toc-number">3.1.</span> <span class="toc-text">FLOW MODELING WITH MACHINE LEARNING</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#材料："><span class="toc-number">3.2.</span> <span class="toc-text">材料：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#环境搭建-对比M1芯片和Nivida3090"><span class="toc-number">3.3.</span> <span class="toc-text">环境搭建-对比M1芯片和Nivida3090</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#实验"><span class="toc-number">4.</span> <span class="toc-text">实验</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RNN-RC-Chaos搭建"><span class="toc-number">5.</span> <span class="toc-text">RNN-RC-Chaos搭建</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考"><span class="toc-number">6.</span> <span class="toc-text">参考</span></a></li></ol></div></div></div><div id="body-wrap"><div id="web_bg" data-type="photo"></div><header class="post-bg" id="page-header" style="background-image: url(https://npg.copernicus.org/articles/27/373/2020/npg-27-373-2020-avatar-web.png)"><nav id="nav"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">DEAL-II-Fluid</a></span><span class="pull-right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fas fa-list"></i><span> 索引</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></li><li><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page"><i class="fa-fw fas fa-list"></i><span> 工具</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/x-codepen/"><i class="fa-fw fa fa-magic"></i><span> codepen</span></a></li><li><a class="site-page" href="/x-gallery/"><i class="fa-fw fa fa-beer"></i><span> gallery</span></a></li><li><a class="site-page" href="/x-shadertoy/"><i class="fa-fw fa fa-star"></i><span> shadertoy</span></a></li><li><a class="site-page" href="/x-webgl1/"><i class="fa-fw fa fa-camera-retro"></i><span> webgl1</span></a></li><li><a class="site-page" href="/x-webgl2/"><i class="fa-fw fa fa-camera-retro"></i><span> webgl2</span></a></li><li><a class="site-page" href="/x-markdown/"><i class="fa-fw fa fa-tree"></i><span> Vditor</span></a></li><li><a class="site-page" href="/plan/"><i class="fa-fw fa fa-heartbeat"></i><span> Paln</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">machine learning for chaos system</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2020-12-11 12:58:34"><i class="far fa-calendar-alt fa-fw"></i> 发表于 2020-12-11</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2020-12-11 23:41:47"><i class="fas fa-history fa-fw"></i> 更新于 2020-12-11</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fas fa-inbox fa-fw post-meta__icon"></i><a class="post-meta__categories" href="/categories/%E5%AD%A6%E4%B9%A0%E4%B8%8E%E6%84%9F%E6%82%9F/">学习与感悟</a></span></div><div class="meta-secondline"> </div><div class="meta-thirdline"><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta__icon"></i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h2 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h2><p>前几天，我的导师发给我一个机器学习的案例，说很感兴趣，可不可能应用在我们的实验台上。我当时的回答是我不敢轻易尝试。从做科研的角度，一直觉得这门学科是非线性动力学和统计学的高深理论，十分敬畏。简简单单地拿tensorflow建个模型，算一下，说自己结果可行，那到底思考在哪里呢？对此，我十分怀疑。</p>
<p>但当我开始学习chaos的一些理论，我又不得不开始思考，中间的一些联系。在此，有必要开辟一个章节，学习和感悟这一话题。尽管题目定的很大—机器学习，但着眼的例子很小（一维K-S 模型）。从非线性流体力学系统出发，希望有所感悟。</p>
<h2 id="学习目标："><a href="#学习目标：" class="headerlink" title="学习目标："></a>学习目标：</h2><ul>
<li>如何构建神经网络模型，来近似模型chaos系统</li>
<li>是否chaos系统可以通过AI模型被预测？比如一些critical pattern？</li>
<li>如何将AI模型与系统的稳定性相互关联？</li>
<li>chaos理论的一些思考和机器学习的一些共性？</li>
</ul>
<h2 id="基本知识："><a href="#基本知识：" class="headerlink" title="基本知识："></a>基本知识：</h2><p><a href="https://vinodsblog.com/2019/01/07/deep-learning-introduction-to-recurrent-neural-networks/" target="_blank" rel="noopener"><strong><em>Recurrent Neural Networks：</em></strong></a></p>
<p>A recurrent neural network is a class of artificial neural networks where connections between nodes form a directed graph along a temporal sequence. This allows it to exhibit temporal dynamic behavior. Derived from feedforward neural networks, RNNs can use their internal state to process variable length sequences of inputs. This makes them applicable to tasks such as unsegmented, connected handwriting recognition or speech recognition.</p>
<p> The main use of RNNs are when using google or Facebook these interfaces are able to predict the next word that you are about to type. RNNs have loops to allow information to persist. This reduces the complexity of parameters, unlike other neural networks. These neural nets are considered to be fairly good for modeling sequence data.  RNNs keep track of a hidden state, that encodes information about the history of the system dynamics.</p>
<p>RNNs have the potential to overcome these scalability problems and be applied to high-dimensional spatio-temporal dynamics.</p>
<p>Recurrent neural networks are a linear architectural variant of recursive networks. They have a “memory” thus it differs from other neural networks. This memory remembers all the information about, what has been calculated in the previous state. It uses the same parameters for each input as it performs the same task on all the inputs or hidden layers to produce the output.</p>
<p>One of the biggest uniqueness RNNs have is “UAP- Universal Approximation Property” thus they can approximate virtually any dynamical system. This unique property forces us to say recurrent neural networks have something magical about them.</p>
<p>RNNs model has been proven to perform extremely well on temporal data. It has several variants including <strong>LSTMs</strong> (long short-term memory), <strong>GRUs</strong> (gated recurrent unit) and <strong>Bidirectional RNNs.</strong> Building models for natural language, audio files, and other sequence data got a lot easier with sequence algorithms.</p>
<p><strong>[Vanishing and Exploding Gradient Problem</strong>-limited](<a href="https://www.programmersought.com/article/93865613569/" target="_blank" rel="noopener">https://www.programmersought.com/article/93865613569/</a>)</p>
<p>This problem sent the major set back for RNNs to get popularity. Values in RNNs can explode or vanish due to a simple reason for remembering previous values. Previous values are good enough to confuse them and cause current values to keep increasing or decreasing &amp; take-over algorithm. Indefinite loops get formed that brings whole network halt.</p>
<p>For example, neurons might get stuck in the loop where it keeps multiplying the previous number to new number which can go to infinity if all numbers are more than one or get stuck at zero if any number is zero.</p>
<p><strong>If the weight is small, multiply it all the time, it will become small. Otherwise it will become very large.</strong>这样深度神经网络的训练也会失效。从深度网络的角度来讲，不同的层学习的速度差异很大，表现为网络中靠近输出的层学习的情况很好，靠近输入的层学习的很慢，有时甚至训练了很久，前几层的权值和刚开始随机初始化的值差不多。因此，梯度消失、爆炸，其根本原因在于反向传播训练法则backpropagation (BPTT)**，属于先天不足。</p>
<h4 id="Reasons-for-the-disappearance-of-the-gradient"><a href="#Reasons-for-the-disappearance-of-the-gradient" class="headerlink" title="Reasons for the disappearance of the gradient:"></a>Reasons for the disappearance of the gradient:</h4><p>(1) Neural network</p>
<p>(2) The initialization weight is too small</p>
<p>(3) Activation function sigmoid (Relu)</p>
<h4 id="Reasons-for-gradient-explosion"><a href="#Reasons-for-gradient-explosion" class="headerlink" title="Reasons for gradient explosion:"></a>Reasons for gradient explosion:</h4><p>(1) Neural network</p>
<p>(2) The initialization weight is too large</p>
<h4 id="How-to-solve-it"><a href="#How-to-solve-it" class="headerlink" title="How to solve it?"></a>How to solve it?</h4><p>(1) Pre-training + fine-tuning</p>
<p>其基本思想是每次训练一层隐节点，训练时将上一层隐节点的输出作为输入，而本层隐节点的输出作为下一层隐节点的 输入，此过程就是逐层“预训练”；在训练完成后，再对整个网络进行“微调”</p>
<p>(2) Gradient shear, regular</p>
<p>梯度剪切这种方案主要是针对梯度爆炸问题，其思想是设置一个梯度阀值。</p>
<p>(3) <strong>Long Short-Term Memory</strong> (LSTM) </p>
<p>LSTMs employ gates that effectively <strong>remember</strong> and <strong>forget</strong> information thus alleviating the problem of vanishing gradients，可以缓解Vanishing and Exploding Gradient Problem。复杂的门可以接下来更新的时候“记住”前几次训练的“残留记忆”。</p>
<p>中间的具体对应关系参考下面的建模方法的图c，有点复杂：</p>
<script type="math/tex; mode=display">
g_t^f=\delta_f (W_f[h_{t-1},o_t]+b_f) , \space\space g_t^i =\delta_i (W_i[h_{t-1},o_t]+b_i)\\\\
\tilde{c}_t = tanh(W_c[h_{t-1},o_t]+b_t), \space c_t = g_t^f \odot c_{t-1} +g_t^i \odot \tilde{c}_t\\\\
g_t^o = \delta_h(W_h[h_{t-1},o_t]+b_h), \space\space h_t =g_t^o \odot tanh(c_t)</script><p>有点像电路板，$g_t^f,g_t^i,g_t^o$分别代表forget, input, output gates. $o_t$ is the observable input at time t, $h_t$ is the hidden state, $c_t$ is the cell state, W is weight matrices, b is biases. The symbol $\odot$ denotes the element-wise product. $\delta$ is <a href="https://en.wikipedia.org/wiki/Sigmoid_function" target="_blank" rel="noopener">Sigmoid function</a>.  The dimension of the hidden state $d_h$ (number of hidden units) controls the capacity of the cell to encode history information. The hidden-to-output functional form $f_h^o$ is given by a linear layer:</p>
<script type="math/tex; mode=display">
\hat{o}_{t+1} = W_o h_t, W_o\in R^{d_0\times d_h}</script><p><strong>Reservior Computing</strong></p>
<p><strong>Reservoir computing</strong> is a framework for computation derived from <a href="https://en.wikipedia.org/wiki/Recurrent_neural_network" target="_blank" rel="noopener">recurrent neural network</a> theory that maps input signals into higher dimensional computational spaces through the dynamics of a fixed, non-linear system called a reservoir.<a href="https://en.wikipedia.org/wiki/Reservoir_computing#cite_note-:4-1" target="_blank" rel="noopener">[1]</a> After the input signal is fed into the reservoir, which is treated as a “black box,” a simple readout mechanism is trained to read the state of the reservoir and map it to the desired output.<a href="https://en.wikipedia.org/wiki/Reservoir_computing#cite_note-:4-1" target="_blank" rel="noopener">[1]</a> The first key benefit of this framework is that training is performed only at the readout stage, as the reservoir dynamics are fixed.<a href="https://en.wikipedia.org/wiki/Reservoir_computing#cite_note-:4-1" target="_blank" rel="noopener">[1]</a> The second is that the computational power of naturally available systems, both classical and quantum mechanical, can be utilized to reduce the effective computational cost.<a href="https://en.wikipedia.org/wiki/Reservoir_computing#cite_note-2" target="_blank" rel="noopener">[2]</a></p>
<p><strong>建模方法</strong></p>
<p>机器学习预测时间序列。给定等间隔$1/triangle t$采样，可观测序列$o\in R^{d_o}$ ,${o_1,…,o_T}$。输入前一个时间点的状态$h_t\in R^{d_h}$.</p>
<script type="math/tex; mode=display">
h_t = f_h^h(o_t,h_{t-1}), \hat{o}_{t+1} = f_h^o (h_t)</script><p>$f_h^h$ is hidden-to-hidden mapping, $f_h^o$ is the hidden-to-output mapping.  下面这四种模型都是这种结构，只是对f的实现和参数有所差异。参见：<sup><a href="#fn_4" id="reffn_4">4</a></sup></p>
<p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/2020-12-1182528.png" alt="示意图"></p>
<p><a href="https://github.com/pvlachas/char-rnn" target="_blank" rel="noopener">具体算法请参考</a></p>
<h4 id="Challenges-and-Opportunities-for-Machine-Learning-in-Fluid-Dynamics5"><a href="#Challenges-and-Opportunities-for-Machine-Learning-in-Fluid-Dynamics5" class="headerlink" title="Challenges and Opportunities for Machine Learning in Fluid Dynamics5"></a>Challenges and Opportunities for Machine Learning in Fluid Dynamics<sup><a href="#fn_5" id="reffn_5">5</a></sup></h4><p>Fluid dynamics presents challenges that differ from those tackled in many applications of machine learning, such as image recognition and advertising. In fluid flows it is often important to precisely quantify the underlying physical mechanisms in order to analyze them. Furthermore, fluids flows entail complex, multi-scale phenomena whose understanding and control remain to a large extent unresolved. <strong>Unsteady flow fields require algorithms capable of addressing nonlinearities and multiple spatiotemporal scales that may not be present in popular machine learning algorithms.</strong> In addition, many prominent applications of machine learning, such as playing video games, rely on inexpensive system evaluations and an exhaustive categorization of the process that must be learned. This is not the case in fluids, where experiments may be difficult to repeat or automate and where simulations may require large-scale supercomputers operating for extended periods of time.</p>
<p> <strong>Dimensionality reduction</strong>  <strong>: POD, PCA and auto-encoders</strong></p>
<p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/20201211102902.png" alt="POD"></p>
<p>特点：网络两边是对称的</p>
<p><a href="https://en.wikipedia.org/wiki/Autoencoder" target="_blank" rel="noopener">Autoencoder</a>: A neural network architecture used to compress and decompress high-dimensional data. They are powerful alternatives to the Proper Orthogonal Decomposition (POD).</p>
<p>用途：</p>
<ul>
<li>重构流场<a href="https://github.com/harsha070/Reconstruction-of-Flows" target="_blank" rel="noopener">https://github.com/harsha070/Reconstruction-of-Flows</a></li>
</ul>
<h3 id="FLOW-MODELING-WITH-MACHINE-LEARNING"><a href="#FLOW-MODELING-WITH-MACHINE-LEARNING" class="headerlink" title="FLOW MODELING WITH MACHINE LEARNING"></a>FLOW MODELING WITH MACHINE LEARNING</h3><ul>
<li><p>dimensionality reduction</p>
<p>Dimensionality reduction involves extracting key features and dominant patterns that may be used as reduced coordinates where the fluid is compactly and efficiently described (Taira et al. 2017). 参见<sup><a href="#fn_5" id="reffn_5">5</a></sup></p>
<p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/20201211110226.png" alt="POD"></p>
</li>
<li><p>Detecting von Karman-type wakes with hydrodynamic sensors<sup><a href="#fn_6" id="reffn_6">6</a></sup></p>
</li>
<li><p>Machine Learning Based Detection of Flow Disturbances Using Surface Pressure Measurements<sup><a href="#fn_7" id="reffn_7">7</a></sup></p>
</li>
</ul>
<p>Data-driven learning to discover macro-scale governing equations<sup><a href="#fn_6" id="reffn_6">6</a></sup></p>
<h3 id="材料："><a href="#材料：" class="headerlink" title="材料："></a>材料：</h3><ul>
<li>ML研究和工程，至少需要Python 3，pandas，numpy，scikit-learn，matplotlib，tensorflow和jupyterlab。</li>
<li>Pytorch 1.7 (3090) 出错问题解决<a href="https://github.com/pytorch/pytorch/issues/49161" target="_blank" rel="noopener">参考</a></li>
</ul>
<h3 id="环境搭建-对比M1芯片和Nivida3090"><a href="#环境搭建-对比M1芯片和Nivida3090" class="headerlink" title="环境搭建-对比M1芯片和Nivida3090"></a>环境搭建-对比M1芯片和Nivida3090</h3><p>测试使用FashionMNIST数据集：</p>
<p>这里简单介绍一下FashionMNIST数据集，原始的MNIST数据集只有1-9的手写数字，整个数据过于简单，无法胜任作为现代CV任务的benchmark的职责，很难有效验证模型的合理性。FashionMNIST包含了60000张训练图片，以及10000张测试集图片，和初代MNIST数据集一样，每张图片都是28 * 28的大小的黑白图片，但是包含的主要是衣服，鞋子，手提包等时尚界物品。图片内容更为复杂，相比于1-9的手写数字，能更为有效的验证模型的合理性。</p>
<p><img src= "/img/loading.gif" data-src="https://pic3.zhimg.com/80/v2-e658c6e5c7dbd645cc883a95e9f81646_1440w.jpg" alt="img"></p>
<p>使用的数据集是 Fashion-MNIST，获取链接如下</p>
<p><a href="https://link.zhihu.com/?target=https%3A//github.com/zalandoresearch/fashion-mnist">https://github.com/zalandoresearch/fashion-mnistgithub.com</a></p>
<h2 id="实验"><a href="#实验" class="headerlink" title="实验"></a>实验</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#import libraries</span></span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment">#download fashion mnist dataset</span></span><br><span class="line">fashion_mnist = tf.keras.datasets.fashion_mnist</span><br><span class="line">(train_images, train_labels), (test_images, test_labels) = fashion_mnist.load_data()</span><br><span class="line"></span><br><span class="line">train_set_count = len(train_labels) <span class="comment">#60000</span></span><br><span class="line">test_set_count = len(test_labels) <span class="comment">#10000</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#setup start time</span></span><br><span class="line">t0 = time.time()</span><br><span class="line"></span><br><span class="line"><span class="comment">#normalize images</span></span><br><span class="line">train_images = train_images / <span class="number">255.0</span></span><br><span class="line">test_images = test_images / <span class="number">255.0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#create ML model</span></span><br><span class="line">model = tf.keras.Sequential([</span><br><span class="line">    tf.keras.layers.Flatten(input_shape=(<span class="number">28</span>, <span class="number">28</span>)),</span><br><span class="line">    tf.keras.layers.Dense(<span class="number">128</span>, activation=<span class="string">'relu'</span>),</span><br><span class="line">    tf.keras.layers.Dense(<span class="number">10</span>)</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="comment">#compile ML model</span></span><br><span class="line">model.compile(optimizer=<span class="string">'adam'</span>,</span><br><span class="line">              loss=tf.keras.losses.SparseCategoricalCrossentropy(from_logits=<span class="literal">True</span>),</span><br><span class="line">              metrics=[<span class="string">'accuracy'</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">#train ML model</span></span><br><span class="line">model.fit(train_images, train_labels, epochs=<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#evaluate ML model on test set</span></span><br><span class="line">test_loss, test_acc = model.evaluate(test_images,  test_labels, verbose=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#setup stop time</span></span><br><span class="line">t1 = time.time()</span><br><span class="line">total_time = t1-t0</span><br><span class="line"></span><br><span class="line"><span class="comment">#print results</span></span><br><span class="line">print(<span class="string">'\n'</span>)</span><br><span class="line">print(<span class="string">f'Training set contained <span class="subst">&#123;train_set_count&#125;</span> images'</span>)</span><br><span class="line">print(<span class="string">f'Testing set contained <span class="subst">&#123;test_set_count&#125;</span> images'</span>)</span><br><span class="line">print(<span class="string">f'Model achieved <span class="subst">&#123;test_acc:<span class="number">.2</span>f&#125;</span> testing accuracy'</span>)</span><br><span class="line">print(<span class="string">f'Training and testing took <span class="subst">&#123;total_time:<span class="number">.2</span>f&#125;</span> seconds'</span>)</span><br></pre></td></tr></table></figure>
<p><strong>RTX 3090 的试验配置</strong></p>
<p>System: Linux</p>
<p>CPU： Intel® Core™ V4-2650</p>
<p>RAM: 128GB</p>
<p>Storage: 1TB SSD</p>
<p>tensorflow环境配置：</p>
<p>docker container run -ti tensorflow/tensorflow</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; print(f&#39;Training set contained &#123;train_set_count&#125; images&#39;)</span><br><span class="line">Training set contained 60000 images</span><br><span class="line">&gt;&gt;&gt; print(f&#39;Testing set contained &#123;test_set_count&#125; images&#39;)</span><br><span class="line">Testing set contained 10000 images</span><br><span class="line">&gt;&gt;&gt; print(f&#39;Model achieved &#123;test_acc:.2f&#125; testing accuracy&#39;)</span><br><span class="line">Model achieved 0.83 testing accuracy</span><br><span class="line">&gt;&gt;&gt; print(f&#39;Training and testing took &#123;total_time:.2f&#125; seconds&#39;)</span><br><span class="line">Training and testing took 40.90 seconds</span><br></pre></td></tr></table></figure>
<p>训练10个epoch，包括test，最终耗时为 40.90s</p>
<p><strong>M1的试验配置</strong></p>
<p>System: macOS Big Sur</p>
<p>Storage: 512GB SSD</p>
<p>Unified Memory: 16GB </p>
<p>M1芯片包含8个CPU核，8个GPU核以及16个神经网络引擎核心。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; <span class="built_in">print</span>(f<span class="string">'Training set contained &#123;train_set_count&#125; images'</span>)</span><br><span class="line">Training <span class="built_in">set</span> contained 60000 images</span><br><span class="line">&gt;&gt;&gt; <span class="built_in">print</span>(f<span class="string">'Testing set contained &#123;test_set_count&#125; images'</span>)</span><br><span class="line">Testing <span class="built_in">set</span> contained 10000 images</span><br><span class="line">&gt;&gt;&gt; <span class="built_in">print</span>(f<span class="string">'Model achieved &#123;test_acc:.2f&#125; testing accuracy'</span>)</span><br><span class="line">Model achieved 0.20 testing accuracy</span><br><span class="line">&gt;&gt;&gt; <span class="built_in">print</span>(f<span class="string">'Training and testing took &#123;total_time:.2f&#125; seconds'</span>)</span><br><span class="line">Training and testing took 6.85 seconds</span><br></pre></td></tr></table></figure>
<p>结论，我买了一张假的3090！?</p>
<p>原来我是放在CPU上了。</p>
<p>继续探索，<a href="https://tf.wiki/zh_hans/appendix/docker.html" target="_blank" rel="noopener">使用docker部署Tensorflow GPU环境</a>：</p>
<p>若需在 TensorFlow Docker 容器中开启 GPU 支持，需要具有一块 NVIDIA 显卡并已正确安装驱动程序。同时需要安装 <a href="https://github.com/NVIDIA/nvidia-docker" target="_blank" rel="noopener">nvidia-docker</a> 。依照官方文档中的 quickstart 部分逐行输入命令即可。</p>
<p>安装完毕后，在 <code>docker container run</code> 命令中添加 <code>--runtime=nvidia</code> 选项，并基于具有 GPU 支持的 TensorFlow Docker 映像启动容器即可，即：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker container run -it --runtime=nvidia tensorflow/tensorflow:latest-gpu-py3 bash</span><br></pre></td></tr></table></figure>
<p><strong>结果</strong>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; #train ML model</span><br><span class="line">... model.fit(train_images, train_labels, epochs&#x3D;10)</span><br><span class="line">Train on 60000 samples</span><br><span class="line">Epoch 1&#x2F;10</span><br><span class="line">60000&#x2F;60000 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 6s 92us&#x2F;sample - loss: 0.4969 - accuracy: 0.8244</span><br><span class="line">Epoch 2&#x2F;10</span><br><span class="line">60000&#x2F;60000 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 5s 91us&#x2F;sample - loss: 0.3787 - accuracy: 0.8631</span><br><span class="line">Epoch 3&#x2F;10</span><br><span class="line">60000&#x2F;60000 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 5s 88us&#x2F;sample - loss: 0.3386 - accuracy: 0.8772</span><br><span class="line">Epoch 4&#x2F;10</span><br><span class="line">60000&#x2F;60000 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 5s 86us&#x2F;sample - loss: 0.3150 - accuracy: 0.8853</span><br><span class="line">Epoch 5&#x2F;10</span><br><span class="line">60000&#x2F;60000 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 5s 86us&#x2F;sample - loss: 0.2967 - accuracy: 0.8906</span><br><span class="line">Epoch 6&#x2F;10</span><br><span class="line">60000&#x2F;60000 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 5s 88us&#x2F;sample - loss: 0.2787 - accuracy: 0.8962</span><br><span class="line">Epoch 7&#x2F;10</span><br><span class="line">60000&#x2F;60000 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 5s 86us&#x2F;sample - loss: 0.2698 - accuracy: 0.9006</span><br><span class="line">Epoch 8&#x2F;10</span><br><span class="line">60000&#x2F;60000 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 5s 86us&#x2F;sample - loss: 0.2576 - accuracy: 0.9036</span><br><span class="line">Epoch 9&#x2F;10</span><br><span class="line">60000&#x2F;60000 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 5s 88us&#x2F;sample - loss: 0.2489 - accuracy: 0.9070</span><br><span class="line">Epoch 10&#x2F;10</span><br><span class="line">60000&#x2F;60000 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 5s 89us&#x2F;sample - loss: 0.2392 - accuracy: 0.9104</span><br></pre></td></tr></table></figure>
<p>用了45s左右，还是很慢。</p>
<p>再仔细看了一下，发现了一些猫腻，在3090GPU上，为何训练的是60000samples整，但在m1上只有1875，这个原因目前还没有找到。60000/1875=32,难道m1还32核并行？</p>
<p>所以还不能直接下结论。倒是证明了一点，m1的速度确实快。</p>
<p><a href="https://github.com/pvlachas/RNN-Lyapunov-Spectrum" target="_blank" rel="noopener">RNN-Lyapunov-Spectrum</a>搭建</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python3 -m venv venv-RNN-Lyapunov-Spectrum</span><br><span class="line">source $HOME/venv-RNN-Lyapunov-Spectrum/bin/activate</span><br></pre></td></tr></table></figure>
<p>安装pytorch，<a href="https://github.com/pytorch/pytorch/issues/49161" target="_blank" rel="noopener">参考</a>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install torch==<span class="number">1.7</span><span class="number">.1</span>+cu110 torchvision==<span class="number">0.8</span><span class="number">.2</span>+cu110 torchaudio===<span class="number">0.7</span><span class="number">.2</span> -f https://download.pytorch.org/whl/torch_stable.html</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install matplotlib scipy psutil tqdm</span><br></pre></td></tr></table></figure>
<p>测试代码<a href="https://github.com/pvlachas/RNN-Lyapunov-Spectrum/blob/master/Experiments/Lorenz3D/0_TRAIN_RNN.sh" target="_blank" rel="noopener">：</a></p>
<h2 id="RNN-RC-Chaos搭建"><a href="#RNN-RC-Chaos搭建" class="headerlink" title="RNN-RC-Chaos搭建"></a><a href="https://github.com/pvlachas/RNN-RC-Chaos" target="_blank" rel="noopener">RNN-RC-Chaos</a>搭建</h2><p>目前只能在linux系统上运行，而且必须在python3.7.3版本上。因此，我们使用conda env<a href="https://blog.csdn.net/qq_40184072/article/details/110371424" target="_blank" rel="noopener">安装虚拟环境</a>。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">conda create -n python3.7 python=3.7.3</span><br><span class="line">conda activate python3.7</span><br><span class="line">pip3 install tensorflow==1.14.0</span><br><span class="line">pip3 install matplotlib sklearn psutil mpi4py</span><br><span class="line">pip3 install torch scipy tqdm <span class="comment">#pytorch</span></span><br><span class="line"><span class="comment"># Downloading torch-1.7.1-cp37-cp37m-manylinux1_x86_64.whl (776.8 MB)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Data  Experiments  Methods  PostProcessing_Paper_RNN-RC  README.md</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── Data</span><br><span class="line">│   ├── KuramotoSivashinskyGP512</span><br><span class="line">│   │   ├── 0_data_generation.py</span><br><span class="line">│   │   ├── 1_creating_figures.py</span><br><span class="line">│   │   ├── 2_creating_video.py</span><br><span class="line">│   │   ├── KS_V1_signal.mp4</span><br><span class="line">│   │   ├── simulation_data.pickle</span><br><span class="line">│   │   ├── testing_data_N100000.pickle</span><br><span class="line">│   │   ├── training_data_N100000.pickle</span><br><span class="line">│   │   └── Utils</span><br><span class="line">│   │       ├── KS.py</span><br><span class="line">│   │       └── __pycache__</span><br><span class="line">│   │           └── KS.cpython-37.pyc</span><br><span class="line">│   ├── Lorenz3D</span><br><span class="line">│   │   ├── 0_data_generation.py</span><br><span class="line">│   │   ├── 0p_data_plotting.py</span><br><span class="line">│   │   ├── 1a_create_figures.py</span><br><span class="line">│   │   ├── 1b_create_figures_projection.py</span><br><span class="line">│   │   ├── 1c_create_figures_sequence.py</span><br><span class="line">│   │   ├── 2_create_training_data.py</span><br><span class="line">│   │   ├── 2p_data_plotting_projection.py</span><br><span class="line">│   │   ├── 2p_data_plotting_sequence.py</span><br><span class="line">│   │   ├── Data</span><br><span class="line">│   │   │   ├── testing_data_N100000_G0-from-1_GS3_GIL0.pickle</span><br><span class="line">│   │   │   ├── testing_data_N100000_G0-from-1_GS3_GIL1.pickle</span><br><span class="line">│   │   │   ├── testing_data_N100000_G0-from-3_GS0_GIL1.pickle</span><br><span class="line">│   │   │   ├── testing_data_N100000_G0-from-3_GS1_GIL1.pickle</span><br><span class="line">│   │   │   ├── testing_data_N100000_G1-from-3_GS1_GIL1.pickle</span><br><span class="line">│   │   │   ├── testing_data_N100000_G2-from-3_GS1_GIL1.pickle</span><br><span class="line">│   │   │   ├── testing_data_N100000.pickle</span><br><span class="line">│   │   │   ├── training_data_N100000_G0-from-1_GS3_GIL0.pickle</span><br><span class="line">│   │   │   ├── training_data_N100000_G0-from-1_GS3_GIL1.pickle</span><br><span class="line">│   │   │   ├── training_data_N100000_G0-from-3_GS0_GIL1.pickle</span><br><span class="line">│   │   │   ├── training_data_N100000_G0-from-3_GS1_GIL1.pickle</span><br><span class="line">│   │   │   ├── training_data_N100000_G1-from-3_GS1_GIL1.pickle</span><br><span class="line">│   │   │   ├── training_data_N100000_G2-from-3_GS1_GIL1.pickle</span><br><span class="line">│   │   │   └── training_data_N100000.pickle</span><br><span class="line">│   │   ├── differential_equation.py</span><br><span class="line">│   │   ├── Figures</span><br><span class="line">│   │   │   └── Trajectories_plot_20000.pdf</span><br><span class="line">│   │   ├── Figures_Projection</span><br><span class="line">│   │   │   ├── Lorenz_Attractor_2D_1_2.pdf</span><br><span class="line">│   │   │   ├── Lorenz_Attractor_2D_1_3.pdf</span><br><span class="line">│   │   │   ├── Lorenz_Attractor_2D_2_3.pdf</span><br><span class="line">│   │   │   └── Lorenz_Attractor.pdf</span><br><span class="line">│   │   ├── Figures_Sequence</span><br><span class="line">│   │   │   ├── Lorenz_sequence_proj_0_N_1000.pdf</span><br><span class="line">│   │   │   └── Lorenz_sequence_proj_0_N_20.pdf</span><br><span class="line">│   │   ├── Simulation_Data</span><br><span class="line">│   │   │   └── lorenz3D_data.pickle</span><br><span class="line">│   │   └── Utils</span><br><span class="line">│   │       ├── differential_equation.py</span><br><span class="line">│   │       ├── lorenz3D.py</span><br><span class="line">│   │       └── __pycache__</span><br><span class="line">│   │           └── lorenz3D.cpython-37.pyc</span><br><span class="line">│   ├── Lorenz96_F10GP40</span><br><span class="line">│   │   ├── 0_data_generation.py</span><br><span class="line">│   │   ├── 1_create_training_data.py</span><br><span class="line">│   │   ├── 2_creating_figures.py</span><br><span class="line">│   │   ├── 3_creating_video.py</span><br><span class="line">│   │   ├── Data</span><br><span class="line">│   │   │   ├── testing_data_N100000.pickle</span><br><span class="line">│   │   │   └── training_data_N100000.pickle</span><br><span class="line">│   │   ├── Figures</span><br><span class="line">│   │   │   ├── Plot_U_first_N100000.png</span><br><span class="line">│   │   │   ├── Plot_U_first_N10000.png</span><br><span class="line">│   │   │   ├── Plot_U_first_N1000.png</span><br><span class="line">│   │   │   ├── Plot_U_last_N100000.png</span><br><span class="line">│   │   │   ├── Plot_U_last_N10000.png</span><br><span class="line">│   │   │   └── Plot_U_last_N1000.png</span><br><span class="line">│   │   ├── lorenz96_F10_signal.mp4</span><br><span class="line">│   │   ├── RUN_ALL.sh</span><br><span class="line">│   │   └── Utils</span><br><span class="line">│   │       └── lorenz96.py</span><br><span class="line">│   ├── Lorenz96_F10GP40R40</span><br><span class="line">│   │   ├── 0_data_generation_svd.py</span><br><span class="line">│   │   ├── 1_create_training_data.py</span><br><span class="line">│   │   ├── 2_creating_figures.py</span><br><span class="line">│   │   ├── 3_creating_video.py</span><br><span class="line">│   │   ├── Data</span><br><span class="line">│   │   │   ├── testing_data_N100000.pickle</span><br><span class="line">│   │   │   └── training_data_N100000.pickle</span><br><span class="line">│   │   ├── Figures</span><br><span class="line">│   │   │   ├── energy_F10.pdf</span><br><span class="line">│   │   │   ├── energy.png</span><br><span class="line">│   │   │   ├── L96Energy-energy_F10.pdf</span><br><span class="line">│   │   │   ├── L96Energy-energy_F10.png</span><br><span class="line">│   │   │   ├── L96Energy-Plot_U_F10.pdf</span><br><span class="line">│   │   │   ├── L96Energy-Plot_U_F10.png</span><br><span class="line">│   │   │   ├── L96Energy-Plot_UR_F10.pdf</span><br><span class="line">│   │   │   ├── L96Energy-Plot_UR_F10.png</span><br><span class="line">│   │   │   ├── L96Energy-Plot_UR_rec_F10.pdf</span><br><span class="line">│   │   │   ├── L96Energy-Plot_UR_rec_F10.png</span><br><span class="line">│   │   │   ├── Plot_U_F10.pdf</span><br><span class="line">│   │   │   ├── Plot_U.png</span><br><span class="line">│   │   │   ├── Plot_UR_F10.pdf</span><br><span class="line">│   │   │   ├── Plot_UR.png</span><br><span class="line">│   │   │   ├── Plot_UR_rec_F10.pdf</span><br><span class="line">│   │   │   └── Plot_UR_rec.png</span><br><span class="line">│   │   ├── lorenz96_F10GP40R_svd_40_signal.mp4</span><br><span class="line">│   │   └── Utils</span><br><span class="line">│   │       └── lorenz96.py</span><br><span class="line">│   ├── Lorenz96_F8GP40</span><br><span class="line">│   │   ├── 0_data_generation.py</span><br><span class="line">│   │   ├── 1_create_training_data.py</span><br><span class="line">│   │   ├── 2_creating_figures.py</span><br><span class="line">│   │   ├── 3_creating_video.py</span><br><span class="line">│   │   ├── Data</span><br><span class="line">│   │   │   ├── testing_data_N100000.pickle</span><br><span class="line">│   │   │   ├── testing_data_N10000.pickle</span><br><span class="line">│   │   │   ├── training_data_N100000.pickle</span><br><span class="line">│   │   │   └── training_data_N10000.pickle</span><br><span class="line">│   │   ├── Figures</span><br><span class="line">│   │   │   ├── Plot_U_first_N100000.png</span><br><span class="line">│   │   │   ├── Plot_U_first_N10000.png</span><br><span class="line">│   │   │   ├── Plot_U_first_N1000.png</span><br><span class="line">│   │   │   ├── Plot_U_last_N100000.png</span><br><span class="line">│   │   │   ├── Plot_U_last_N10000.png</span><br><span class="line">│   │   │   └── Plot_U_last_N1000.png</span><br><span class="line">│   │   ├── lorenz96_F8_signal.mp4</span><br><span class="line">│   │   ├── RUN_ALL.sh</span><br><span class="line">│   │   └── Utils</span><br><span class="line">│   │       └── lorenz96.py</span><br><span class="line">│   └── Lorenz96_F8GP40R40</span><br><span class="line">│       ├── 0_data_generation_svd.py</span><br><span class="line">│       ├── 1_create_training_data.py</span><br><span class="line">│       ├── 2_creating_figures.py</span><br><span class="line">│       ├── 3_creating_video.py</span><br><span class="line">│       ├── 4_le_calculation.py</span><br><span class="line">│       ├── Data</span><br><span class="line">│       │   ├── testing_data_N100000.pickle</span><br><span class="line">│       │   └── training_data_N100000.pickle</span><br><span class="line">│       ├── Figures</span><br><span class="line">│       │   ├── energy_F8.pdf</span><br><span class="line">│       │   ├── energy.png</span><br><span class="line">│       │   ├── L96Energy-energy_F8.png</span><br><span class="line">│       │   ├── L96Energy-Plot_U_F8.png</span><br><span class="line">│       │   ├── L96Energy-Plot_UR_F8.png</span><br><span class="line">│       │   ├── L96Energy-Plot_UR_rec_F8.png</span><br><span class="line">│       │   ├── Plot_U_F8.pdf</span><br><span class="line">│       │   ├── Plot_U.png</span><br><span class="line">│       │   ├── Plot_UR_F8.pdf</span><br><span class="line">│       │   ├── Plot_UR.png</span><br><span class="line">│       │   ├── Plot_UR_rec_F8.pdf</span><br><span class="line">│       │   └── Plot_UR_rec.png</span><br><span class="line">│       ├── lorenz96_F8GP40R_svd_40_signal.mp4</span><br><span class="line">│       └── Utils</span><br><span class="line">│           └── lorenz96.py</span><br><span class="line">├── Experiments</span><br><span class="line">│   ├── KuramotoSivashinskyGP512</span><br><span class="line">│   │   └── Local</span><br><span class="line">│   │       ├── 01_ESN_auto.sh</span><br><span class="line">│   │       ├── 01_ESN_lsqr.sh</span><br><span class="line">│   │       ├── 01_ESN_pinv.sh</span><br><span class="line">│   │       ├── 02_RNNStatefull_Unit.sh</span><br><span class="line">│   │       ├── 03_RNNStatefull_LSTM.sh</span><br><span class="line">│   │       ├── 04_RNNStatefull_GRU.sh</span><br><span class="line">│   │       ├── 05_ESN_Parallel.sh</span><br><span class="line">│   │       ├── 06_RNNStatefull_Parallel_Unit.sh</span><br><span class="line">│   │       ├── 07_RNNStatefull_Parallel_LSTM.sh</span><br><span class="line">│   │       └── 08_RNNStatefull_Parallel_GRU.sh</span><br><span class="line">│   ├── Lorenz3D</span><br><span class="line">│   │   └── Local</span><br><span class="line">│   │       ├── 01_ESN_auto.sh</span><br><span class="line">│   │       ├── 01_ESN_lsqr.sh</span><br><span class="line">│   │       ├── 01_ESN_pinv.sh</span><br><span class="line">│   │       ├── 02_RNNStatefull_Unit.sh</span><br><span class="line">│   │       ├── 03_RNNStatefull_LSTM.sh</span><br><span class="line">│   │       ├── 04_RNNStatefull_GRU.sh</span><br><span class="line">│   │       ├── 05_ESN_Parallel.sh</span><br><span class="line">│   │       ├── 06_RNNStatefull_Parallel_Unit.sh</span><br><span class="line">│   │       ├── 07_RNNStatefull_Parallel_LSTM.sh</span><br><span class="line">│   │       ├── 08_RNNStatefull_Parallel_GRU.sh</span><br><span class="line">│   │       └── 09_RNNStatefull_GRU_twolayer.sh</span><br><span class="line">│   ├── Lorenz96_F10GP40</span><br><span class="line">│   │   └── Local</span><br><span class="line">│   │       ├── 00_MLP.sh</span><br><span class="line">│   │       ├── 01_ESN.sh</span><br><span class="line">│   │       ├── 02_RNNStatefull_Unit.sh</span><br><span class="line">│   │       ├── 03_RNNStatefull_LSTM.sh</span><br><span class="line">│   │       └── 04_RNNStatefull_GRU.sh</span><br><span class="line">│   ├── Lorenz96_F10GP40R40</span><br><span class="line">│   │   └── Local</span><br><span class="line">│   │       ├── 00_MLP.sh</span><br><span class="line">│   │       ├── 01_ESN.sh</span><br><span class="line">│   │       ├── 02_RNNStatefull_Unit.sh</span><br><span class="line">│   │       ├── 03_RNNStatefull_LSTM.sh</span><br><span class="line">│   │       └── 04_RNNStatefull_GRU.sh</span><br><span class="line">│   ├── Lorenz96_F8GP40</span><br><span class="line">│   │   └── Local</span><br><span class="line">│   │       ├── 00_MLP.sh</span><br><span class="line">│   │       ├── 01_ESN.sh</span><br><span class="line">│   │       ├── 02_RNNStatefull_Unit.sh</span><br><span class="line">│   │       ├── 03_RNNStatefull_LSTM.sh</span><br><span class="line">│   │       └── 04_RNNStatefull_GRU.sh</span><br><span class="line">│   └── Lorenz96_F8GP40R40</span><br><span class="line">│       └── Local</span><br><span class="line">│           ├── 00_MLP.sh</span><br><span class="line">│           ├── 01_ESN.sh</span><br><span class="line">│           ├── 02_RNNStatefull_Unit.sh</span><br><span class="line">│           ├── 03_RNNStatefull_LSTM.sh</span><br><span class="line">│           └── 04_RNNStatefull_GRU.sh</span><br><span class="line">├── Methods</span><br><span class="line">│   ├── Config</span><br><span class="line">│   │   ├── global_conf.py</span><br><span class="line">│   │   └── __pycache__</span><br><span class="line">│   │       ├── global_conf.cpython-37.pyc</span><br><span class="line">│   │       └── global_conf.cpython-38.pyc</span><br><span class="line">│   ├── Models</span><br><span class="line">│   │   ├── esn</span><br><span class="line">│   │   │   ├── esn.py</span><br><span class="line">│   │   │   ├── __pycache__</span><br><span class="line">│   │   │   │   ├── esn.cpython-37.pyc</span><br><span class="line">│   │   │   │   ├── esn.cpython-38.pyc</span><br><span class="line">│   │   │   │   ├── utils.cpython-37.pyc</span><br><span class="line">│   │   │   │   └── utils.cpython-38.pyc</span><br><span class="line">│   │   │   └── utils.py</span><br><span class="line">│   │   ├── esn_parallel</span><br><span class="line">│   │   │   ├── esn_parallel.py</span><br><span class="line">│   │   │   └── utils.py</span><br><span class="line">│   │   ├── mlp</span><br><span class="line">│   │   │   └── mlp.py</span><br><span class="line">│   │   ├── rnn_statefull</span><br><span class="line">│   │   │   ├── eunn_cell.py</span><br><span class="line">│   │   │   ├── __pycache__</span><br><span class="line">│   │   │   │   ├── eunn_cell.cpython-37.pyc</span><br><span class="line">│   │   │   │   ├── eunn_cell.cpython-38.pyc</span><br><span class="line">│   │   │   │   ├── rnn_statefull.cpython-37.pyc</span><br><span class="line">│   │   │   │   ├── rnn_statefull.cpython-38.pyc</span><br><span class="line">│   │   │   │   ├── utils.cpython-37.pyc</span><br><span class="line">│   │   │   │   ├── utils.cpython-38.pyc</span><br><span class="line">│   │   │   │   ├── zoneout_wrapper.cpython-37.pyc</span><br><span class="line">│   │   │   │   └── zoneout_wrapper.cpython-38.pyc</span><br><span class="line">│   │   │   ├── rnn_statefull.py</span><br><span class="line">│   │   │   ├── utils.py</span><br><span class="line">│   │   │   └── zoneout_wrapper.py</span><br><span class="line">│   │   ├── rnn_statefull_parallel</span><br><span class="line">│   │   │   ├── eunn_cell.py</span><br><span class="line">│   │   │   ├── __pycache__</span><br><span class="line">│   │   │   │   ├── eunn_cell.cpython-38.pyc</span><br><span class="line">│   │   │   │   ├── rnn_statefull_parallel.cpython-38.pyc</span><br><span class="line">│   │   │   │   └── zoneout_wrapper.cpython-38.pyc</span><br><span class="line">│   │   │   ├── rnn_statefull_parallel.py</span><br><span class="line">│   │   │   ├── utils.py</span><br><span class="line">│   │   │   └── zoneout_wrapper.py</span><br><span class="line">│   │   └── Utils</span><br><span class="line">│   │       ├── global_utils.py</span><br><span class="line">│   │       ├── plotting_utils.py</span><br><span class="line">│   │       └── __pycache__</span><br><span class="line">│   │           ├── global_utils.cpython-37.pyc</span><br><span class="line">│   │           ├── global_utils.cpython-38.pyc</span><br><span class="line">│   │           ├── plotting_utils.cpython-37.pyc</span><br><span class="line">│   │           └── plotting_utils.cpython-38.pyc</span><br><span class="line">│   └── RUN.py</span><br><span class="line">├── PostProcessing_Paper_RNN-RC</span><br><span class="line">│   ├── POSTPROCESS_0.py</span><br><span class="line">│   ├── POSTPROCESS_10c.py</span><br><span class="line">│   ├── POSTPROCESS_10.py</span><br><span class="line">│   ├── POSTPROCESS_11.py</span><br><span class="line">│   ├── POSTPROCESS_12b_OLD.py</span><br><span class="line">│   ├── POSTPROCESS_12b.py</span><br><span class="line">│   ├── POSTPROCESS_12c.py</span><br><span class="line">│   ├── POSTPROCESS_12.py</span><br><span class="line">│   ├── POSTPROCESS_13.py</span><br><span class="line">│   ├── POSTPROCESS_15b.py</span><br><span class="line">│   ├── POSTPROCESS_15c.py</span><br><span class="line">│   ├── POSTPROCESS_15d.py</span><br><span class="line">│   ├── POSTPROCESS_15.py</span><br><span class="line">│   ├── POSTPROCESS_1.py</span><br><span class="line">│   ├── POSTPROCESS_2.py</span><br><span class="line">│   ├── POSTPROCESS_3b.py</span><br><span class="line">│   ├── POSTPROCESS_3c.py</span><br><span class="line">│   ├── POSTPROCESS_3.py</span><br><span class="line">│   ├── POSTPROCESS_4.py</span><br><span class="line">│   ├── POSTPROCESS_5.py</span><br><span class="line">│   ├── POSTPROCESS_6.py</span><br><span class="line">│   ├── POSTPROCESS_7.py</span><br><span class="line">│   ├── POSTPROCESS_8.py</span><br><span class="line">│   ├── POSTPROCESS_9.py</span><br><span class="line">│   ├── POSTPROCESS_PARALLEL_10c.py</span><br><span class="line">│   ├── POSTPROCESS_PARALLEL_10.py</span><br><span class="line">│   ├── POSTPROCESS_PARALLEL_11.py</span><br><span class="line">│   ├── POSTPROCESS_PARALLEL_12.py</span><br><span class="line">│   ├── POSTPROCESS_PARALLEL_13b.py</span><br><span class="line">│   ├── POSTPROCESS_PARALLEL_13.py</span><br><span class="line">│   ├── POSTPROCESS_PARALLEL_14.py</span><br><span class="line">│   ├── POSTPROCESS_PARALLEL_15.py</span><br><span class="line">│   ├── POSTPROCESS_PARALLEL_2.py</span><br><span class="line">│   ├── run_all_daint.sh</span><br><span class="line">│   ├── run_parallel_all.sh</span><br><span class="line">│   └── Utils</span><br><span class="line">│       └── utils.py</span><br><span class="line">├── README.md</span><br><span class="line">└── Results</span><br><span class="line">    ├── KuramotoSivashinskyGP512</span><br><span class="line">    │   ├── Evaluation_Data</span><br><span class="line">    │   │   ├── RNN-esn_auto-RDIM_512-N_used_1000-SIZE_1000-D_10.0-RADIUS_0.6-SIGMA_1.0-DL_200-NL_0-IPL_200-REG_0.0-WID_0</span><br><span class="line">    │   │   ├── RNN-esn_lsqr-RDIM_512-N_used_1000-SIZE_1000-D_10.0-RADIUS_0.6-SIGMA_1.0-DL_200-NL_0-IPL_200-REG_0.0-WID_0</span><br><span class="line">    │   │   └── RNN-esn_pinv-RDIM_1-N_used_1000-SIZE_1000-D_10.0-RADIUS_0.9-SIGMA_1.0-DL_200-NL_0-IPL_200-REG_0.0-WID_0</span><br><span class="line">    │   ├── Figures</span><br><span class="line">    │   │   ├── RNN-esn_auto-RDIM_512-N_used_1000-SIZE_1000-D_10.0-RADIUS_0.6-SIGMA_1.0-DL_200-NL_0-IPL_200-REG_0.0-WID_0</span><br><span class="line">    │   │   ├── RNN-esn_lsqr-RDIM_512-N_used_1000-SIZE_1000-D_10.0-RADIUS_0.6-SIGMA_1.0-DL_200-NL_0-IPL_200-REG_0.0-WID_0</span><br><span class="line">    │   │   └── RNN-esn_pinv-RDIM_1-N_used_1000-SIZE_1000-D_10.0-RADIUS_0.9-SIGMA_1.0-DL_200-NL_0-IPL_200-REG_0.0-WID_0</span><br><span class="line">    │   ├── Logfiles</span><br><span class="line">    │   │   ├── RNN-esn_auto-RDIM_512-N_used_1000-SIZE_1000-D_10.0-RADIUS_0.6-SIGMA_1.0-DL_200-NL_0-IPL_200-REG_0.0-WID_0</span><br><span class="line">    │   │   ├── RNN-esn_lsqr-RDIM_512-N_used_1000-SIZE_1000-D_10.0-RADIUS_0.6-SIGMA_1.0-DL_200-NL_0-IPL_200-REG_0.0-WID_0</span><br><span class="line">    │   │   └── RNN-esn_pinv-RDIM_1-N_used_1000-SIZE_1000-D_10.0-RADIUS_0.9-SIGMA_1.0-DL_200-NL_0-IPL_200-REG_0.0-WID_0</span><br><span class="line">    │   └── Trained_Models</span><br><span class="line">    │       ├── RNN-esn_auto-RDIM_512-N_used_1000-SIZE_1000-D_10.0-RADIUS_0.6-SIGMA_1.0-DL_200-NL_0-IPL_200-REG_0.0-WID_0</span><br><span class="line">    │       ├── RNN-esn_lsqr-RDIM_512-N_used_1000-SIZE_1000-D_10.0-RADIUS_0.6-SIGMA_1.0-DL_200-NL_0-IPL_200-REG_0.0-WID_0</span><br><span class="line">    │       └── RNN-esn_pinv-RDIM_1-N_used_1000-SIZE_1000-D_10.0-RADIUS_0.9-SIGMA_1.0-DL_200-NL_0-IPL_200-REG_0.0-WID_0</span><br><span class="line">    └── Lorenz3D</span><br><span class="line">        ├── Evaluation_Data</span><br><span class="line">        │   ├── RNN-esn_auto-RDIM_1-N_used_1000-SIZE_1000-D_10.0-RADIUS_0.6-SIGMA_1.0-DL_200-NL_10-IPL_500-REG_0.0-WID_0</span><br><span class="line">        │   │   └── results.pickle</span><br><span class="line">        │   └── RNN-esn_lsqr-RDIM_1-N_used_1000-SIZE_1000-D_10.0-RADIUS_0.6-SIGMA_1.0-DL_200-NL_0-IPL_500-REG_0.0-WID_0</span><br><span class="line">        │       └── results.pickle</span><br><span class="line">        ├── Figures</span><br><span class="line">        │   ├── RNN-esn_auto-RDIM_1-N_used_1000-SIZE_1000-D_10.0-RADIUS_0.6-SIGMA_1.0-DL_200-NL_10-IPL_500-REG_0.0-WID_0</span><br><span class="line">        │   │   ├── frequencies_TEST.png</span><br><span class="line">        │   │   ├── frequencies_TRAIN.png</span><br><span class="line">        │   │   ├── prediction_augmend_TEST_30814.png</span><br><span class="line">        │   │   ├── prediction_augmend_TEST_63827.png</span><br><span class="line">        │   │   ├── prediction_augmend_TRAIN_30814.png</span><br><span class="line">        │   │   ├── prediction_augmend_TRAIN_63827.png</span><br><span class="line">        │   │   ├── prediction_TEST_30814_error.png</span><br><span class="line">        │   │   ├── prediction_TEST_30814_log_error.png</span><br><span class="line">        │   │   ├── prediction_TEST_30814_nerror.png</span><br><span class="line">        │   │   ├── prediction_TEST_30814.png</span><br><span class="line">        │   │   ├── prediction_TEST_63827_error.png</span><br><span class="line">        │   │   ├── prediction_TEST_63827_log_error.png</span><br><span class="line">        │   │   ├── prediction_TEST_63827_nerror.png</span><br><span class="line">        │   │   ├── prediction_TEST_63827.png</span><br><span class="line">        │   │   ├── prediction_TRAIN_30814_error.png</span><br><span class="line">        │   │   ├── prediction_TRAIN_30814_log_error.png</span><br><span class="line">        │   │   ├── prediction_TRAIN_30814_nerror.png</span><br><span class="line">        │   │   ├── prediction_TRAIN_30814.png</span><br><span class="line">        │   │   ├── prediction_TRAIN_63827_error.png</span><br><span class="line">        │   │   ├── prediction_TRAIN_63827_log_error.png</span><br><span class="line">        │   │   ├── prediction_TRAIN_63827_nerror.png</span><br><span class="line">        │   │   └── prediction_TRAIN_63827.png</span><br><span class="line">        │   └── RNN-esn_lsqr-RDIM_1-N_used_1000-SIZE_1000-D_10.0-RADIUS_0.6-SIGMA_1.0-DL_200-NL_0-IPL_500-REG_0.0-WID_0</span><br><span class="line">        │       ├── frequencies_TEST.png</span><br><span class="line">        │       ├── frequencies_TRAIN.png</span><br><span class="line">        │       ├── prediction_augmend_TEST_30814.png</span><br><span class="line">        │       ├── prediction_augmend_TRAIN_30814.png</span><br><span class="line">        │       ├── prediction_TEST_30814_error.png</span><br><span class="line">        │       ├── prediction_TEST_30814_log_error.png</span><br><span class="line">        │       ├── prediction_TEST_30814_nerror.png</span><br><span class="line">        │       ├── prediction_TEST_30814.png</span><br><span class="line">        │       ├── prediction_TRAIN_30814_error.png</span><br><span class="line">        │       ├── prediction_TRAIN_30814_log_error.png</span><br><span class="line">        │       ├── prediction_TRAIN_30814_nerror.png</span><br><span class="line">        │       └── prediction_TRAIN_30814.png</span><br><span class="line">        ├── Logfiles</span><br><span class="line">        │   ├── RNN-esn_auto-RDIM_1-N_used_1000-SIZE_1000-D_10.0-RADIUS_0.6-SIGMA_1.0-DL_200-NL_10-IPL_500-REG_0.0-WID_0</span><br><span class="line">        │   │   ├── test.txt</span><br><span class="line">        │   │   └── train.txt</span><br><span class="line">        │   └── RNN-esn_lsqr-RDIM_1-N_used_1000-SIZE_1000-D_10.0-RADIUS_0.6-SIGMA_1.0-DL_200-NL_0-IPL_500-REG_0.0-WID_0</span><br><span class="line">        │       ├── test.txt</span><br><span class="line">        │       └── train.txt</span><br><span class="line">        └── Trained_Models</span><br><span class="line">            ├── RNN-esn_auto-RDIM_1-N_used_1000-SIZE_1000-D_10.0-RADIUS_0.6-SIGMA_1.0-DL_200-NL_10-IPL_500-REG_0.0-WID_0</span><br><span class="line">            │   └── data.pickle</span><br><span class="line">            └── RNN-esn_lsqr-RDIM_1-N_used_1000-SIZE_1000-D_10.0-RADIUS_0.6-SIGMA_1.0-DL_200-NL_0-IPL_500-REG_0.0-WID_0</span><br><span class="line">                └── data.pickle</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"># 01_ESN_auto.sh</span><br><span class="line"># 参数</span><br><span class="line">#!&#x2F;bin&#x2F;bash</span><br><span class="line">  </span><br><span class="line">cd ..&#x2F;..&#x2F;..&#x2F;Methods</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">python3 RUN.py esn \ # method : esn</span><br><span class="line">--mode all \ </span><br><span class="line">--display_output 1 \</span><br><span class="line">--system_name Lorenz3D \</span><br><span class="line">--write_to_log 1 \</span><br><span class="line">--N 100000 \</span><br><span class="line">--N_used 1000 \</span><br><span class="line">--RDIM 1 \</span><br><span class="line">--noise_level 10 \</span><br><span class="line">--scaler Standard \</span><br><span class="line">--approx_reservoir_size 1000 \</span><br><span class="line">--degree 10 \</span><br><span class="line">--radius 0.6 \</span><br><span class="line">--sigma_input 1 \</span><br><span class="line">--regularization 0.0 \</span><br><span class="line">--dynamics_length 200 \</span><br><span class="line">--iterative_prediction_length 500 \</span><br><span class="line">--num_test_ICS 2 \</span><br><span class="line">--solver auto \</span><br><span class="line">--number_of_epochs 1000000 \</span><br><span class="line">--learning_rate 0.001 \</span><br><span class="line">--reference_train_time 10 \</span><br><span class="line">--buffer_train_time 0.5</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># # -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="string">"""Created by: Vlachas Pantelis, CSE-lab, ETH Zurich</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> Config.global_conf <span class="keyword">import</span> global_params</span><br><span class="line">sys.path.insert(<span class="number">0</span>, global_params.global_utils_path)</span><br><span class="line"><span class="keyword">from</span> plotting_utils <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> global_utils <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getModel</span><span class="params">(params)</span>:</span></span><br><span class="line">        sys.path.insert(<span class="number">0</span>, global_params.py_models_path.format(params[<span class="string">"model_name"</span>]))</span><br><span class="line">        <span class="keyword">if</span> params[<span class="string">"model_name"</span>] == <span class="string">"esn"</span>:</span><br><span class="line">                <span class="keyword">import</span> esn <span class="keyword">as</span> model</span><br><span class="line">                <span class="keyword">return</span> model.esn(params)</span><br><span class="line">        <span class="keyword">elif</span> params[<span class="string">"model_name"</span>] == <span class="string">"esn_parallel"</span>:</span><br><span class="line">                <span class="keyword">import</span> esn_parallel <span class="keyword">as</span> model</span><br><span class="line">                <span class="keyword">return</span> model.esn_parallel(params)</span><br><span class="line">        <span class="keyword">elif</span> params[<span class="string">"model_name"</span>] == <span class="string">"rnn_statefull"</span>:</span><br><span class="line">                <span class="keyword">import</span> rnn_statefull <span class="keyword">as</span> model</span><br><span class="line">                <span class="keyword">return</span> model.rnn_statefull(params)</span><br><span class="line">        <span class="keyword">elif</span> params[<span class="string">"model_name"</span>] == <span class="string">"rnn_statefull_parallel"</span>:</span><br><span class="line">                <span class="keyword">import</span> rnn_statefull_parallel <span class="keyword">as</span> model</span><br><span class="line">                <span class="keyword">return</span> model.rnn_statefull_parallel(params)</span><br><span class="line">        <span class="keyword">elif</span> params[<span class="string">"model_name"</span>] == <span class="string">"mlp"</span>:</span><br><span class="line">                <span class="keyword">import</span> mlp <span class="keyword">as</span> model</span><br><span class="line">                <span class="keyword">return</span> model.mlp(params)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">"model not found."</span>)</span><br><span class="line">                <span class="function"><span class="keyword">def</span> <span class="title">runModel</span><span class="params">(params_dict)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> params_dict[<span class="string">"mode"</span>] <span class="keyword">in</span> [<span class="string">"train"</span>, <span class="string">"all"</span>]:</span><br><span class="line">                trainModel(params_dict)</span><br><span class="line">        <span class="keyword">if</span> params_dict[<span class="string">"mode"</span>] <span class="keyword">in</span> [<span class="string">"test"</span>, <span class="string">"all"</span>]:</span><br><span class="line">                testModel(params_dict)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">trainModel</span><span class="params">(params_dict)</span>:</span></span><br><span class="line">        model = getModel(params_dict)</span><br><span class="line">        model.train()</span><br><span class="line">        model.delete()</span><br><span class="line">        <span class="keyword">del</span> model</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">testModel</span><span class="params">(params_dict)</span>:</span></span><br><span class="line">        model = getModel(params_dict)</span><br><span class="line">        model.testing()</span><br><span class="line">        model.delete()</span><br><span class="line">        <span class="keyword">del</span> model</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">defineParser</span><span class="params">()</span>:</span></span><br><span class="line">        parser = argparse.ArgumentParser()</span><br><span class="line">        subparsers = parser.add_subparsers(help=<span class="string">'Selection of the model.'</span>, dest=<span class="string">'model_name'</span>)</span><br><span class="line"></span><br><span class="line">        esn_parser = subparsers.add_parser(<span class="string">"esn"</span>)</span><br><span class="line">        esn_parser = getESNParser(esn_parser)</span><br><span class="line"></span><br><span class="line">        esn_parallel_parser = subparsers.add_parser(<span class="string">"esn_parallel"</span>)</span><br><span class="line">        esn_parallel_parser = getESNParallelParser(esn_parallel_parser)</span><br><span class="line"></span><br><span class="line">        rnn_statefull_parser = subparsers.add_parser(<span class="string">"rnn_statefull"</span>)</span><br><span class="line">        rnn_statefull_parser = getRNNStatefullParser(rnn_statefull_parser)</span><br><span class="line"></span><br><span class="line">        rnn_statefull_parallel_parser = subparsers.add_parser(<span class="string">"rnn_statefull_parallel"</span>)</span><br><span class="line">        rnn_statefull_parallel_parser = getRNNStatefullParallelParser(rnn_statefull_parallel_parser)</span><br><span class="line">          mlp_parser = subparsers.add_parser(<span class="string">"mlp"</span>)</span><br><span class="line">        mlp_parser = getMLPParser(mlp_parser)</span><br><span class="line"></span><br><span class="line">        mlp_parallel_parser = subparsers.add_parser(<span class="string">"mlp_parallel"</span>)</span><br><span class="line">        mlp_parallel_parser = getMLPParallelParser(mlp_parallel_parser)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> parser</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">        parser = defineParser()</span><br><span class="line">        args = parser.parse_args()</span><br><span class="line">        print(args.model_name)</span><br><span class="line">        args_dict = args.__dict__</span><br><span class="line"></span><br><span class="line">        <span class="comment"># for key in args_dict:</span></span><br><span class="line">                <span class="comment"># print(key)</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># DEFINE PATHS AND DIRECTORIES</span></span><br><span class="line">        args_dict[<span class="string">"saving_path"</span>] = global_params.saving_path.format(args_dict[<span class="string">"system_name"</span>])</span><br><span class="line">        args_dict[<span class="string">"model_dir"</span>] = global_params.model_dir</span><br><span class="line">        args_dict[<span class="string">"fig_dir"</span>] = global_params.fig_dir</span><br><span class="line">        args_dict[<span class="string">"results_dir"</span>] = global_params.results_dir</span><br><span class="line">        args_dict[<span class="string">"logfile_dir"</span>] = global_params.logfile_dir</span><br><span class="line">        args_dict[<span class="string">"train_data_path"</span>] = global_params.training_data_path.format(args.system_name, args.N)</span><br><span class="line">        args_dict[<span class="string">"test_data_path"</span>] = global_params.testing_data_path.format(args.system_name, args.N)</span><br><span class="line">        args_dict[<span class="string">"worker_id"</span>] = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        runModel(args_dict)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">        main()</span><br></pre></td></tr></table></figure>
<p>结果输出：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># test.txt</span><br><span class="line">model_name:RNN-esn_auto-RDIM_1-N_used_1000-SIZE_1000-D_10.0-RADIUS_0.6-SIGMA_1.0-DL_200-NL_10-IPL_500-REG_0.0-WID_0:num_test_ICS:2.00:num_accurate_pred_005_avg_TEST:20.00:num_accurate_pred_050_avg_TEST:82.00:num_accurate_pred_005_avg_TRAIN:14.00:num_accurate_pred_050_avg_TRAIN:93.50:error_freq_TRAIN:4.68:error_freq_TEST:2.14</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># train.txt</span><br><span class="line">model_name:RNN-esn_auto-RDIM_1-N_used_1000-SIZE_1000-D_10.0-RADIUS_0.6-SIGMA_1.0-DL_200-NL_10-IPL_500-REG_0.0-WID_0:memory:110.07:total_training_time:1.02:n_model_parameters:12000:n_trainable_parameters:1000</span><br></pre></td></tr></table></figure>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><blockquote id="fn_1">
<sup>1</sup>. [2019 SIAM Conference on Applications of Dynamical Systems<a href="#reffn_1" title="Jump back to footnote [1] in the text."> &#8617;</a>
</blockquote>
<blockquote id="fn_2">
<sup>2</sup>. <a href="https://github.com/pvlachas/RNN-RC-Chaos" target="_blank" rel="noopener">https://github.com/pvlachas/RNN-RC-Chaos</a><a href="#reffn_2" title="Jump back to footnote [2] in the text."> &#8617;</a>
</blockquote>
<blockquote id="fn_4">
<sup>4</sup>. Backpropagation Algorithms and Reservoir Computing in Recurrent Neural Networks for the Forecasting of Complex Spatiotemporal Dynamics<a href="#reffn_4" title="Jump back to footnote [4] in the text."> &#8617;</a>
</blockquote>
<blockquote id="fn_5">
<sup>5</sup>. Machine Learning for Fluid Mechanics<a href="#reffn_5" title="Jump back to footnote [5] in the text."> &#8617;</a>
</blockquote>
<blockquote id="fn_6">
<sup>6</sup>. Detecting exotic wakes with hydrodynamic sensors Mengying Wang and Maziar S. Hemati<a href="#reffn_6" title="Jump back to footnote [6] in the text."> &#8617;</a>
</blockquote>
<blockquote id="fn_7">
<sup>7</sup>. AIAA conference-2019,Machine Learning Based Detection of Flow Disturbances Using Surface Pressure Measurements Wei Hou∗1 , Darwin Darakananda†1 , and Jeff D. Eldredge‡1<a href="#reffn_7" title="Jump back to footnote [7] in the text."> &#8617;</a>
</blockquote>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Jiaqi</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://deal-ii.com/post/2a0d5be4/">http://deal-ii.com/post/2a0d5be4/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://deal-ii.com" target="_blank">DEAL-II-Fluid</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/chao-s-theory/">chao's theory</a><a class="post-meta__tags" href="/tags/machine-learning/">machine learning</a></div><div class="post_share"><div class="social-share" data-image="https://npg.copernicus.org/articles/27/373/2020/npg-27-373-2020-avatar-web.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/post/6f1f143a/"><img class="next-cover" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/cover-blog-shader.webp" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">unix</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/post/845ed395/" title="chaos-未完。。。"><img class="relatedPosts_cover" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/chaoblogcover.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-11-26</div><div class="relatedPosts_title">chaos-未完。。。</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headling"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div class="comments-items-1" data-name="Valine"><div class="vcomment" id="vcomment"></div><script>function loadvaline () {  
  var requestSetting = function (from,set) {
    var from = from
    var setting = set.split(',').filter(function(item){
    return from.indexOf(item) > -1
    });
    setting = setting.length == 0 ? from :setting;
    return setting
  }

  var guestInfo = requestSetting(['nick','mail','link'],'nick,mail,link')
  var requiredFields = requestSetting(['nick','mail'],'nick,mail')

  function initValine () {
    window.valine = new Valine({
      el:'#vcomment',
      appId: 'lJ3vEzEWaeVa6HpWNNbPrauw-gzGzoHsz',
      appKey: '16FI6zgDXwvw71g04yhHnnW0',
      placeholder: 'Please leave your footprints',
      avatar: 'monsterid',
      meta: guestInfo,
      pageSize: '10',
      lang: 'en',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: false,
      requiredFields: requiredFields
    });
  }
  loadScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js', initValine)
}

if ('Valine' === 'Valine' || false) {
  window.addEventListener('load', loadvaline)
}
else {
  function loadOtherComment () {
    loadvaline()
  }
}</script></div></div></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020  <i id="heartbeat" class="fa fas fa-heartbeat"></i> Jiaqi</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div><head><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/HCLonely/images@master/others/heartbeat.min.css"><meta name="generator" content="Hexo 4.2.0"></head></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font_plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font_minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  CommonHTML: {
    linebreaks: { automatic: true, width: "90% container" }
  },
  "HTML-CSS": { 
    linebreaks: { automatic: true, width: "90% container" }
  },
  "SVG": { 
    linebreaks: { automatic: true, width: "90% container" }
  }
});
</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for (i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.jsdelivr.net/npm/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js" async></script><script src="/js/calendar.js"></script><script src="/js/languages.js"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/haruto.model.json"},"display":{"position":"right","width":120,"height":260},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>